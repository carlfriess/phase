package(default_visibility = ["//visibility:public"])

filegroup(
    name = "hdrs",
    srcs = glob([
        "components/*.h",
        "components/ble/**/*.h",
        "components/boards/*.h",
        "components/libraries/**/*.h",
        "components/nfc/**/*.h",
        "components/toolchain/cmsis/include/*.h",
        "external/fprintf/*.h",
        "external/segger_rtt/*.h",
        "external/utf_converter/*.h",
        "integration/nrfx/**/*.h",
        "modules/nrfx/**/*.h",
    ] + [
        "components/softdevice/common/*.h",
        "components/softdevice/s132/headers/*.h",
        "components/softdevice/s132/headers/nrf52/*.h",
    ]),
)

includes = glob(
    include = [
        "components/libraries/*",
    ],
    exclude_directories = 0,
) + [
    "components",
    "components/ble/ble_advertising",
    "components/ble/ble_db_discovery",
    "components/ble/ble_dtm",
    "components/ble/ble_racp",
    "components/ble/ble_services/ble_ancs_c",
    "components/ble/ble_services/ble_ans_c",
    "components/ble/ble_services/ble_bas",
    "components/ble/ble_services/ble_bas_c",
    "components/ble/ble_services/ble_cscs",
    "components/ble/ble_services/ble_cts_c",
    "components/ble/ble_services/ble_dfu",
    "components/ble/ble_services/ble_dis",
    "components/ble/ble_services/ble_gls",
    "components/ble/ble_services/ble_hids",
    "components/ble/ble_services/ble_hrs",
    "components/ble/ble_services/ble_hrs_c",
    "components/ble/ble_services/ble_hts",
    "components/ble/ble_services/ble_ias",
    "components/ble/ble_services/ble_ias_c",
    "components/ble/ble_services/ble_lbs",
    "components/ble/ble_services/ble_lbs_c",
    "components/ble/ble_services/ble_lls",
    "components/ble/ble_services/ble_nus",
    "components/ble/ble_services/ble_nus_c",
    "components/ble/ble_services/ble_rscs",
    "components/ble/ble_services/ble_rscs_c",
    "components/ble/ble_services/ble_tps",
    "components/ble/ble_services/experimental_gatts_c",
    "components/ble/common",
    "components/ble/nrf_ble_gatt",
    "components/ble/nrf_ble_gq",
    "components/ble/nrf_ble_qwr",
    "components/ble/peer_manager",
    "components/boards",
    "components/libraries/bootloader/ble_dfu",
    "components/libraries/log/src",
    "components/libraries/usbd/class/audio",
    "components/libraries/usbd/class/cdc",
    "components/libraries/usbd/class/cdc/acm",
    "components/libraries/usbd/class/hid",
    "components/libraries/usbd/class/hid/generic",
    "components/libraries/usbd/class/hid/kbd",
    "components/libraries/usbd/class/hid/mouse",
    "components/libraries/usbd/class/msc",
    "components/nfc/ndef/conn_hand_parser",
    "components/nfc/ndef/conn_hand_parser/ac_rec_parser",
    "components/nfc/ndef/conn_hand_parser/ble_oob_advdata_parser",
    "components/nfc/ndef/conn_hand_parser/le_oob_rec_parser",
    "components/nfc/ndef/connection_handover/ac_rec",
    "components/nfc/ndef/connection_handover/ble_oob_advdata",
    "components/nfc/ndef/connection_handover/ble_pair_lib",
    "components/nfc/ndef/connection_handover/ble_pair_msg",
    "components/nfc/ndef/connection_handover/common",
    "components/nfc/ndef/connection_handover/ep_oob_rec",
    "components/nfc/ndef/connection_handover/hs_rec",
    "components/nfc/ndef/connection_handover/le_oob_rec",
    "components/nfc/ndef/generic/message",
    "components/nfc/ndef/generic/record",
    "components/nfc/ndef/launchapp",
    "components/nfc/ndef/parser/message",
    "components/nfc/ndef/parser/record",
    "components/nfc/ndef/text",
    "components/nfc/ndef/uri",
    "components/nfc/platform",
    "components/nfc/t2t_lib",
    "components/nfc/t2t_parser",
    "components/nfc/t4t_lib",
    "components/nfc/t4t_parser/apdu",
    "components/nfc/t4t_parser/cc_file",
    "components/nfc/t4t_parser/hl_detection_procedure",
    "components/nfc/t4t_parser/tlv",
    "components/toolchain/cmsis/include",
    "external/fprintf",
    "external/segger_rtt",
    "external/utf_converter",
    "integration/nrfx",
    "integration/nrfx/legacy",
    "modules/nrfx",
    "modules/nrfx/drivers/include",
    "modules/nrfx/hal",
    "modules/nrfx/mdk",
] + [
    "components/softdevice/common",
    "components/softdevice/s132/headers",
    "components/softdevice/s132/headers/nrf52",
]

cc_library(
    name = "sdk",
    srcs = [":hdrs"],
    hdrs = [":hdrs"],
    data = ["modules/nrfx/mdk"],
    includes = includes,
    linkopts = [
        "-L $(location @nRF5//:modules/nrfx/mdk)",
    ],
    linkstatic = 1,
    deps = [
        "modules/nrfx/mdk/nrf_common.ld",
    ],
)

config_setting(
    name = "host_macOS",
    values = {"host_cpu": "darwin"},
)

config_setting(
    name = "host_linux",
    values = {"host_cpu": "k8"},
)

exports_files(glob(["**"]))
